MODULE: IGA_for_bsplyne.ProblemIGA
==================================
Documentation du module IGA_for_bsplyne.ProblemIGA

CLASSE: ProblemIGA
------------------
ProblemIGA class to compute linear elasticity on 3D multipatch B-spline volumes.
This class computes the stiffness matrix and the right hand side and solves the linear problem.

Attributes
----------
patches : list[IGAPatch]
    List of IGAPatch objects representing the patches for the ProblemIGA.
connectivity : MultiPatchBSplineConnectivity
    MultiPatchBSplineConnectivity object defining the connectivity information.
dirichlet : Dirichlet
    Dirichlet object specifying the Dirichlet boundary conditions.

  >>> __init__(
    self,
    patches: list[IGA_for_bsplyne.IGAPatch.IGAPatch],
    connectivity: bsplyne.multi_patch_b_spline.MultiPatchBSplineConnectivity,
    dirichlet: IGA_for_bsplyne.Dirichlet.Dirichlet
)
      Initialize the ProblemIGA class with the provided patches, connectivity, and dirichlet.
      
      Parameters
      ----------
      patches : list[IGAPatch]
          List of IGAPatch objects representing the patches for the ProblemIGA.
      connectivity : MultiPatchBSplineConnectivity
          MultiPatchBSplineConnectivity object defining the connectivity information.
      dirichlet : Dirichlet
          Dirichlet object specifying the Dirichlet boundary conditions.

  >>> lhs_rhs(
    self,
    verbose: bool = False,
    disable_parallel: bool = False
) -> tuple[scipy.sparse._matrix.spmatrix, numpy.ndarray[numpy.floating]]
      Assemble the global left-hand side (lhs) matrix and right-hand side (rhs) vector
      for the linear system of equations.
      
      Parameters
      ----------
      verbose : bool, optional
          If True, prints progress messages during the assembly process, by default False.
      disable_parallel : bool, optional
          Wether to disable parallel exectution. By default, False.
      
      Returns
      -------
      lhs, rhs : tuple[sps.spmatrix, np.ndarray[np.floating]]
          The assembled sparse left-hand side matrix and right-hand side vector.

  >>> apply_dirichlet(
    self,
    lhs: scipy.sparse._matrix.spmatrix,
    rhs: numpy.ndarray[numpy.floating],
    verbose: bool = False
) -> tuple[scipy.sparse._matrix.spmatrix, numpy.ndarray[numpy.floating]]
      Apply Dirichlet boundary conditions to the system of equations.
      
      Parameters
      ----------
      lhs : sps.spmatrix
          The left-hand side sparse matrix of the system.
      rhs : np.ndarray[np.floating]
          The right-hand side vector of the system.
      verbose : bool, optional
          If True, prints progress messages, by default False.
      
      Returns
      -------
      lhs, rhs : tuple[sps.spmatrix, np.ndarray[np.floating]]
          The modified left-hand side matrix and right-hand side vector
          after applying Dirichlet boundary conditions.

  >>> solve_from_lhs_rhs(
    self,
    lhs: scipy.sparse._matrix.spmatrix,
    rhs: numpy.ndarray[numpy.floating],
    iterative_solve: bool = False,
    verbose: bool = True
) -> numpy.ndarray[numpy.floating]
      Solve the linear system defined by the left-hand side (lhs) matrix and right-hand side (rhs) vector.
      
      Parameters
      ----------
      lhs : sps.spmatrix
          The left-hand side sparse matrix of the system.
      rhs : np.ndarray[np.floating]
          The right-hand side vector of the system.
      iterative_solve : bool, optional
          If True, use an iterative solver (conjugate gradient with diagonal preconditioner),
          otherwise use a direct solver (Cholesky factorization).
          Specs for 1_534_278 dof :
              - CG preconditioned with diagonal (`scipy.sparse.diags(1/lhs.diagonal())`):
                  solved to 1e-5 tol in 131 min
              - CG preconditioned with AMG (`pyamg.smoothed_aggregation_solver(lhs).aspreconditioner()`):
                  solved to 1e-5 tol in 225 min
              - Cholesky: solved in 32 min
          By default False.
      verbose : bool, optional
          If True, print progress messages during the solving process, by default True.
      
      Returns
      -------
      dof : np.ndarray[np.floating]
          The solution vector representing the degrees of freedom.

  >>> solve(self, iterative_solve=False) -> numpy.ndarray[numpy.floating]
      Solve the linear system for the ProblemIGA class using ProcessPoolExecutor with block splitting.
      
      Parameters
      ----------
      iterative_solve : bool, optional
          Whether to use an iterative solver or not, default is False.
          The iterative solver is a sparse conjugate gradient with a diagonal preconditioner.
          The direct solver is a Cholesky sparse solver.
          Specs for 1_534_278 dof :
              - CG preconditioned with diagonal (`scipy.sparse.diags(1/lhs.diagonal())`):
                  solved to 1e-5 tol in 131 min
              - CG preconditioned with AMG (`pyamg.smoothed_aggregation_solver(lhs).aspreconditioner()`):
                  solved to 1e-5 tol in 225 min
              - Cholesky: solved in 32 min
      
      Returns
      -------
      u : np.ndarray[np.floating]
          Solution vector representing the computed displacements in packed notation.
          Shape : (3(phy), nb_unique_nodes)

  >>> save_paraview(
    self,
    u: numpy.ndarray[numpy.floating],
    path: str,
    name: str,
    n_eval_per_elem: int = 10
)
      Save the computed displacements and related fields to Paraview format for visualization.
      
      Parameters
      ----------
      u : np.ndarray[np.floating]
          Displacement field in packed notation as a numpy array of shape (3(phy), nb_unique_nodes).
      path : str
          Path to save the Paraview files.
      name : str
          Name of the Paraview files.
      n_eval_per_elem : int, optional
          Number of evaluations per element, default is 10.

